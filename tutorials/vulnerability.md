# Hướng dẫn: Tìm và sửa các phụ thuộc có lỗ hổng bảo mật

Hướng dẫn này sẽ chỉ cho bạn cách tìm và sửa các lỗ hổng bảo mật trong các phụ thuộc của dự án Go của bạn sử dụng `govulncheck`.

> **Lưu ý:** Để xem các hướng dẫn khác, xem [Hướng dẫn](../doc.md).

## Tổng quan

Go cung cấp các công cụ để giúp bạn quản lý các lỗ hổng bảo mật trong các phụ thuộc của mình. Công cụ chính là `govulncheck`, một công cụ dòng lệnh phân tích cơ sở mã của bạn và báo cáo các lỗ hổng đã biết ảnh hưởng đến mã của bạn.

## Yêu cầu tiên quyết

- Go 1.18 trở lên đã được cài đặt
- Một dự án Go với file `go.mod`

## Bước 1: Cài đặt govulncheck

Cài đặt công cụ `govulncheck` sử dụng lệnh sau:

```bash
$ go install golang.org/x/vuln/cmd/govulncheck@latest
```

Điều này sẽ cài đặt phiên bản mới nhất của `govulncheck` vào thư mục `$GOBIN` của bạn.

## Bước 2: Chạy govulncheck

Điều hướng đến thư mục gốc của dự án Go của bạn (nơi chứa file `go.mod`) và chạy:

```bash
$ govulncheck ./...
```

Lệnh này sẽ:
1. Phân tích tất cả các package trong module của bạn
2. Kiểm tra các phụ thuộc của bạn với Cơ sở dữ liệu Lỗ hổng Go
3. Báo cáo bất kỳ lỗ hổng nào ảnh hưởng đến mã của bạn

### Hiểu đầu ra

Đầu ra của `govulncheck` sẽ cho bạn biết:
- Lỗ hổng nào được tìm thấy
- Package nào bị ảnh hưởng
- Phiên bản sửa lỗi (nếu có)
- Liệu mã của bạn có thực sự gọi code có lỗ hổng hay không

Ví dụ đầu ra:

```
Scanning your code and P packages across M dependent modules for known vulnerabilities...

Vulnerability #1: GO-2023-1234
  A vulnerability in example.com/vulnerable-pkg
  
  More info: https://pkg.go.dev/vuln/GO-2023-1234
  
  Module: example.com/vulnerable-pkg
    Found in: example.com/vulnerable-pkg@v1.2.3
    Fixed in: example.com/vulnerable-pkg@v1.2.4
    
  Call stacks in your code:
    main.go:15:8: yourpackage.Function calls vulnerable-pkg.VulnerableFunction
```

## Bước 3: Sửa các lỗ hổng

### Cập nhật các phụ thuộc

Cách phổ biến nhất để sửa các lỗ hổng là cập nhật các phụ thuộc bị ảnh hưởng lên phiên bản đã được vá:

```bash
$ go get example.com/vulnerable-pkg@v1.2.4
$ go mod tidy
```

### Xác minh các sửa chữa

Sau khi cập nhật, chạy lại `govulncheck` để xác nhận các lỗ hổng đã được giải quyết:

```bash
$ govulncheck ./...
```

Nếu thành công, bạn sẽ thấy:

```
No vulnerabilities found.
```

## Bước 4: Tích hợp vào quy trình CI/CD

Bạn có thể tích hợp `govulncheck` vào quy trình CI/CD của mình để tự động kiểm tra các lỗ hổng:

### GitHub Actions

```yaml
name: Security Check

on: [push, pull_request]

jobs:
  govulncheck:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    - uses: actions/setup-go@v4
      with:
        go-version: '1.21'
    - name: Install govulncheck
      run: go install golang.org/x/vuln/cmd/govulncheck@latest
    - name: Run govulncheck
      run: govulncheck ./...
```

## Các tùy chọn bổ sung

### Kiểm tra chỉ một package

```bash
$ govulncheck ./path/to/package
```

### Hiển thị tất cả các lỗ hổng (bao gồm cả những lỗ hổng không ảnh hưởng đến mã)

```bash
$ govulncheck -show verbose ./...
```

### Đầu ra dạng JSON

```bash
$ govulncheck -json ./...
```

## Thực hành tốt nhất

1. **Chạy govulncheck thường xuyên**: Tích hợp kiểm tra lỗ hổng vào quy trình phát triển hàng ngày của bạn.

2. **Cập nhật phụ thuộc thường xuyên**: Giữ các phụ thuộc của bạn được cập nhật để nhận các bản vá bảo mật mới nhất.

3. **Xem xét chuỗi gọi**: `govulncheck` chỉ báo cáo các lỗ hổng mà mã của bạn thực sự sử dụng. Xem xét chuỗi gọi để hiểu tác động thực sự.

4. **Theo dõi Go vulnerability database**: Đăng ký để nhận thông báo về các lỗ hổng mới tại [vuln.go.dev](https://vuln.go.dev/).

## Tài nguyên bổ sung

- [Go Vulnerability Database](https://vuln.go.dev/)
- [govulncheck documentation](https://pkg.go.dev/golang.org/x/vuln/cmd/govulncheck)
- [Vulnerability Management Overview](https://go.dev/security/vuln/)

---

*Tài liệu này được dịch từ [go.dev/doc/tutorial/govulncheck](https://go.dev/doc/tutorial/govulncheck) để phục vụ cộng đồng lập trình viên Việt Nam.*
